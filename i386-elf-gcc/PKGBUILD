# Maintainer: Dani Rodr√≠guez <dani@danirod.es>
pkgname=i386-elf-gcc
pkgver=5.2.0
pkgrel=1
pkgdesc="GNU Compiler Collection targetting i386-elf"
arch=('i686' 'x86_64')
url="https://gcc.gnu.org"
license=('GPL')
groups=()
depends=(zlib libmpc)
makedepends=(clang gmp mpfr)
source=("http://ftpmirror.gnu.org/gcc/gcc-5.2.0/gcc-5.2.0.tar.bz2")
sha256sums=("5f835b04b5f7dd4f4d2dc96190ec1621b8d89f2dc6f638f9f8bc1b1014ba8cad")

build() {
        mkdir -p "gcc-build"
        cd "gcc-build"
        ../gcc-$pkgver/configure --prefix=/usr \
                                 --target=i386-elf \
                                 --disable-multilib \
                                 --disable-nls \
                                 --disable-werror \
                                 --without-headers \
                                 --enable-languages=c,c++ \
                                 CC=clang \
                                 CXX=clang++

        make all-gcc CPPFLAGS=''
        make all-target-libgcc CPPFLAGS=''
}

package() {
        cd gcc-build
        make install-gcc DESTDIR=$pkgdir
        make install-target-libgcc DESTDIR=$pkgdir

        # Some files will cause conflict with host tools.
        rm -rf $pkgdir/usr/share/info
        rm -rf $pkgdir/usr/share/man/man7
}
